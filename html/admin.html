<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>管理员空间</title>
        <script src="https://cdn.staticfile.org/jquery/3.4.0/jquery.min.js"></script>
        <script src="https://cdn.staticfile.org/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
        <script src="https://cdn.bootcss.com/toastr.js/latest/js/toastr.min.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/toastr.js/latest/css/toastr.min.css">

        <link rel="stylesheet" href="../statics/css/custom.css"/>
        <link rel="stylesheet" href="../statics/css/paper.css"/>
        <style>
            .clearfix::after, .clearfix::before {
                content: "";
                display: block;
                clear: both;
            }

            #pageFooter {
                background-color: #444545;
                color: white;
                font-size: 12px;
                height: 50px;
                font-family: 微软雅黑;
                line-height: 50px;
                text-align: center;
            }

            #navigation {
                list-style-type: none;
                background-color: rgb(240, 240, 240);
                height: 50px;
            }

            #navigation li {
                margin-right: 30px;
                float: left;
                line-height: 50px;
                padding: 0 20px 0 20px;
            }

            #navigation li:hover {
                cursor: pointer;
                background-color: rgb(70, 70, 70);
                color: white;
            }

            #display {
                width: 4590px;
                position: relative;
                transition: 1s;
            }

            .content {
                float: left;
                width: 918px;
                height: 500px;
                padding: 10px;
            }

            #content1 {
            }

            #content2 {
            }

            .tables {
                text-align: center;
            }

            .delete {
                font-size: 14px;
                outline: none;
                border-radius: 15px;
                width: 100px;
                height: 30px;
                color: white;
                text-align: center;
                background-color: rgb(221, 83, 71);
                line-height: 30px;
                padding: 0;
            }
        </style>
        <script>
            var host = "http://127.0.0.1:8080"

            var deleteIn = function (id) {
                $.post({
                    url: host + "/insurance/delete",
                    data: {
                        id: id
                    },
                    success: function (data) {
                        if (data === 1) {
                            var button = document.getElementById(id)
                            button.parentNode.parentNode.parentNode.removeChild(button.parentNode.parentNode)
                            toastr.success("已删除该险种")
                        } else {
                            toastr.warning("请稍后操作！！")
                        }
                    },
                    error: function () {
                        toastr.error("网络错误，请稍后重试！！")
                    }
                })
            }

            var deleteSa = function (id) {
                $.post({
                    url: host + "/sales/delete",
                    data: {
                        jobNumber: id
                    },
                    success: function (data) {
                        if (data === 1) {
                            var button = document.getElementById(id)
                            button.parentNode.parentNode.parentNode.removeChild(button.parentNode.parentNode)
                            toastr.success("已删除该险种")
                        } else {
                            toastr.warning("请稍后操作！！")
                        }
                    },
                    error: function () {
                        toastr.error("网络错误，请稍后重试！！")
                    }
                })
            }
        </script>
    </head>
    <body>
        <div class="container paper clearfix" style="padding: 1rem">
            <div id="nav" class="clearfix paper" style="padding: 1rem">
                <h3>这里是Deluxe保险的管理区域</h3>
            </div>
            <ul id="navigation" class="clearfix">
                <li>险种查询</li>
                <li>业务员查询</li>
                <li>保单查询</li>
                <li>增加险种</li>
                <li>增加业务员</li>
            </ul>
            <div style="overflow-x: hidden">
                <div id="display">
                    <div id="content1" class="content">
                        <table class="tables">
                            <th>#</th>
                            <th>险种名称</th>
                            <th>适用人群</th>
                            <th>保费</th>
                            <th>操作</th>
                            <tbody id="details">

                            </tbody>
                        </table>
                    </div>
                    <script>
                        var details = document.getElementById("details")
                        var getAge = function (index, array) {
                            let ageStart = array[index].ageStart
                            let ageEnd = array[index].ageEnd
                            let startArray = ageStart.split(".")
                            let endArray = ageEnd.split(".")
                            let yearStart = startArray[0]
                            let mouthStart = startArray[1]
                            let dayStart = startArray[2]
                            let yearEnd = endArray[0]
                            let mouthEnd = endArray[1]
                            let dayEnd = endArray[2]
                            return yearStart + "岁" + mouthStart + "月" + dayStart + "天~~" + yearEnd + "岁" + mouthEnd + "月" + dayEnd + "天"
                        }
                        $.post({
                            url: host + "/insurance/getInAll",
                            success: function (data) {
                                for (let i = 0; i < data.length; i++) {
                                    details.innerHTML += "<tr>" +
                                        "<td>" + data[i].id + "</td>" +
                                        "<td>" + data[i].iname + "</td>" +
                                        "<td>" + getAge(i, data) + "</td>" +
                                        "<td>" + data[i].premium + "</td>" +
                                        "<td><button id='" + data[i].id + "' class='delete' onclick='deleteIn(this.id)'>删除</button></td>" +
                                        "</tr>"
                                }
                            },
                            error: function () {
                                toastr.error("网络错误，请稍后重试！！")
                            }
                        })
                    </script>
                    <div id="content2" class="content">
                        <table class="tables">
                            <th>#</th>
                            <th>业务员姓名</th>
                            <th>性别</th>
                            <th>身份证号</th>
                            <th>电话号码</th>
                            <th>操作</th>
                            <tbody id="details1">

                            </tbody>
                        </table>
                    </div>
                    <script>
                        var details1 = document.getElementById("details1")
                        $.post({
                            url: host + "/query/salesList",
                            success: function (data) {
                                console.log(data)
                                for (let i = 0; i < data.length; i++) {
                                    details1.innerHTML += "<tr>" +
                                        "<td>" + data[i].jobNumber + "</td>" +
                                        "<td>" + data[i].sname + "</td>" +
                                        "<td>" + (data[i].gender === 0 ? "女" : "男") + "</td>" +
                                        "<td>" + data[i].idCard + "</td>" +
                                        "<td>" + data[i].phone + "</td>" +
                                        "<td><button id='" + data[i].jobNumber + "' class='delete' onclick='deleteSa(this.id)'>删除</button></td>" +
                                        "</tr>"
                                }
                            }
                        })
                    </script>
                    <div id="content3" class="content"></div>
                    <div id="content4" class="content"></div>
                    <div id="content5" class="content"></div>
                </div>
            </div>
            <br/>
            <div id="pageFooter">
                Copyright©2020 Deluxe 3017216029@tju.edu.cn
            </div>
        </div>
        <script>
            var display = document.getElementById("display")
            $("#navigation li").click(function () {
                let pos = $(this).index()
                $("#display").css("left", -pos * 918 + "px")
            })
        </script>
    </body>
</html>